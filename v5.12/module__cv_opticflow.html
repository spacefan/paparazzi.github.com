<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Paparazzi UAS: cv_opticflow module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="penguin_icon.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Paparazzi UAS
   &#160;<span id="projectnumber">v5.12_stable-2-g9c592a7-dirty</span>
   </div>
   <div id="projectbrief">Paparazzi is a free software Unmanned Aircraft System.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('module__cv_opticflow.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">cv_opticflow module </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Compute optical flow.</b></p>
<p><b></b></p>
<p>Made for Linux video Devices. Computes x and y velocity using optical flow and distance to ground (using sonar).</p>
<h1><a class="anchor" id="module_load_example__cv_opticflow"></a>
Example for airframe file</h1>
<p>Add to your firmware section: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;module name=&quot;video_thread&quot;/&gt;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;&lt;module name=&quot;pose_history&quot;/&gt;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;&lt;module name=&quot;cv_opticflow&quot;/&gt;</div>
</div><!-- fragment --> <h1><a class="anchor" id="configuration__cv_opticflow"></a>
Module configuration options</h1>
<h2><a class="anchor" id="af_section"></a>
Airframe file section</h2>
<ul>
<li><b>section</b> name: <code>OPTICFLOW</code> prefix: <code>OPTICFLOW_</code> <ul>
<li><b>name</b> <code>AGL_ID</code> <b>value:</b> <em>ABI_BROADCAST</em> <br />
 Description: ABI receive id for ABI message (sonar measurement) (default: ABI_BROADCAST)</li>
<li><b>name</b> <code>IMU_ID</code> <b>value:</b> <em>ABI_BROADCAST</em> <br />
 Description: ABI receive id for ABI message (accelerometers) (default: ABI_BROADCAST)</li>
<li><b>name</b> <code>BODY_TO_IMU_ID</code> <b>value:</b> <em>ABI_BROADCAST</em> <br />
 Description: ABI receive id for ABI message (body to imu quat) (default: ABI_BROADCAST)</li>
<li><b>name</b> <code>SEND_ABI_ID</code> <b>value:</b> <em>1</em> <br />
 Description: ABI sender id for opticflow messages (default: 1)</li>
<li><b>name</b> <code>CAMERA</code> <b>value:</b> <em>bottom_camera|front_camera</em> <br />
 Description: The V4L2 camera device that is used for the calculations</li>
<li><b>name</b> <code>FOV_W</code> <b>value:</b> <em>0.89360857702</em> <br />
 Description: The field of view width of the bottom camera (Defaults are from an ARDrone 2)</li>
<li><b>name</b> <code>FOV_H</code> <b>value:</b> <em>0.67020643276</em> <br />
 Description: The field of view height of the bottom camera (Defaults are from an ARDrone 2)</li>
<li><b>name</b> <code>FX</code> <b>value:</b> <em>343.1211</em> <br />
 Description: Field in the x direction of the camera (Defaults are from an ARDrone 2)</li>
<li><b>name</b> <code>FY</code> <b>value:</b> <em>348.5053</em> <br />
 Description: Field in the y direction of the camera (Defaults are from an ARDrone 2)</li>
<li><b>name</b> <code>DEROTATION_CORRECTION_FACTOR_X</code> <b>value:</b> <em>1.0</em> <br />
 Description: Correction factor for derotation (in x direction), estimated from a fit between the gyro's rates and the resulting flow (caused by the camera not being exactly in the middle (Defaults are from an ARDrone 2)</li>
<li><b>name</b> <code>DEROTATION_CORRECTION_FACTOR_Y</code> <b>value:</b> <em>1.0</em> <br />
 Description: Correction factor for derotation (in y direction), estimated from a fit between the gyro's rates and the resulting flow (caused by the camera not being exactly in the middle (Defaults are from an ARDrone 2)</li>
<li><b>name</b> <code>METHOD</code> <b>value:</b> <em>0</em> <br />
 Description: Method used to calculate optical flow</li>
<li><b>name</b> <code>WINDOW_SIZE</code> <b>value:</b> <em>10</em> <br />
 Description: Window size used for block matching (pixels)</li>
<li><b>name</b> <code>SEARCH_DISTANCE</code> <b>value:</b> <em>10</em> <br />
 Description: Maximum search distance for blockmatching (pixels)</li>
<li><b>name</b> <code>SUBPIXEL_FACTOR</code> <b>value:</b> <em>10</em> <br />
 Description: Amount of subpixels per pixel, used for more precise (subpixel) calculations of the flow</li>
<li><b>name</b> <code>RESOLUTION_FACTOR</code> <b>value:</b> <em>1000</em> <br />
 Description: The resolution factor needed to calculate the divergence without floats</li>
<li><b>name</b> <code>DEROTATION</code> <b>value:</b> <em>1</em> <br />
 Description: Derotation either turned on or off (depended on gyroscope measurements)</li>
<li><b>name</b> <code>MEDIAN_FILTER</code> <b>value:</b> <em>0</em> <br />
 Description: A median filter on the resulting velocities to be turned on or off (last 5 measurements)</li>
<li><b>name</b> <code>KALMAN_FILTER</code> <b>value:</b> <em>1</em> <br />
 Description: A kalman filter on the resulting velocities to be turned on or off (fused with accelerometers)</li>
<li><b>name</b> <code>KALMAN_FILTER_PROCESS_NOISE</code> <b>value:</b> <em>0.01</em> <br />
 Description: The expected variance of the error of the model's prediction in the kalman filter</li>
<li><b>name</b> <code>FEATURE_MANAGEMENT</code> <b>value:</b> <em>1</em> <br />
 Description: Whether to keep already tracked corners in memory for the next frame or re-detect new ones every time</li>
<li><b>name</b> <code>FPS</code> <b>value:</b> <em>0</em> <br />
 Description: The (maximum) frequency to run the calculations at. If zero, it will max out at the camera frame rate</li>
<li><b>name</b> <code>MAX_TRACK_CORNERS</code> <b>value:</b> <em>25</em> <br />
 Description: The maximum amount of corners the Lucas Kanade algorithm is tracking between two frames</li>
<li><b>name</b> <code>MAX_ITERATIONS</code> <b>value:</b> <em>10</em> <br />
 Description: Maximum number of iterations the Lucas Kanade algorithm should take</li>
<li><b>name</b> <code>THRESHOLD_VEC</code> <b>value:</b> <em>2</em> <br />
 Description: TThreshold in subpixels when the iterations of Lucas Kanade should stop</li>
<li><b>name</b> <code>FAST9_ADAPTIVE</code> <b>value:</b> <em>TRUE</em> <br />
 Description: Whether we should use and adapative FAST9 crner detection threshold</li>
<li><b>name</b> <code>FAST9_THRESHOLD</code> <b>value:</b> <em>20</em> <br />
 Description: FAST9 default threshold</li>
<li><b>name</b> <code>FAST9_MIN_DISTANCE</code> <b>value:</b> <em>10</em> <br />
 Description: The amount of pixels between corners that should be detected</li>
<li><b>name</b> <code>FAST9_PADDING</code> <b>value:</b> <em>20</em> <br />
 Description: The outer border in which no corners will be searched</li>
<li><b>name</b> <code>FAST9_REGION_DETECT</code> <b>value:</b> <em>1</em> <br />
 Description: Whether to detect fast9 corners in regions of interest or the whole image (only works with feature management)</li>
<li><b>name</b> <code>FAST9_NUM_REGIONS</code> <b>value:</b> <em>9</em> <br />
 Description: The number of regions of interest to split the image into</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="dependencies__cv_opticflow"></a>
Dependencies</h1>
<ul>
<li><a class="el" href="module__video_thread.html">video_thread module</a></li>
<li><a class="el" href="module__pose_history.html">pose_history module</a> </li>
</ul>
<h1><a class="anchor" id="functions__cv_opticflow"></a>
Module functions</h1>
<h2><a class="anchor" id="init_functions"></a>
Init Functions</h2>
<p>These initialization functions are called once on startup.</p>
<ul>
<li><a class="el" href="opticflow__module_8c.html#a6026660ee86fbb1f72bada581386e6d9" title="Initialize the optical flow module for the bottom camera. ">opticflow_module_init()</a></li>
</ul>
<h2><a class="anchor" id="periodic_functions"></a>
Periodic Functions</h2>
<p>These functions are called periodically at the specified frequency from the module periodic loop.</p>
<ul>
<li><a class="el" href="opticflow__module_8c.html#abf53d072984591ae6710a65682d6bedb" title="Update the optical flow state for the calculation thread and update the stabilization loops with the ...">opticflow_module_run()</a><ul>
<li>Running at maximum module frequency.</li>
<li>Autorun: <em>TRUE</em> <br />
 Periodic function automatically starts after init.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="files"></a>
Files</h1>
<h2><a class="anchor" id="headers"></a>
Header Files</h2>
<p>The following headers are automatically included in modules.h</p>
<ul>
<li><a class="el" href="opticflow__module_8h.html">opticflow_module.h</a></li>
</ul>
<h2><a class="anchor" id="sources"></a>
Source Files</h2>
<ul>
<li><a class="el" href="image_8c.html">modules/computer_vision/lib/vision/image.c</a></li>
<li><a class="el" href="jpeg_8c.html">modules/computer_vision/lib/encoding/jpeg.c</a></li>
<li><a class="el" href="rtp_8c.html">modules/computer_vision/lib/encoding/rtp.c</a></li>
<li><a class="el" href="v4l2_8c.html">modules/computer_vision/lib/v4l/v4l2.c</a></li>
<li><a class="el" href="opticflow__module_8c.html">modules/computer_vision/opticflow_module.c</a></li>
<li><a class="el" href="opticflow__calculator_8c.html">modules/computer_vision/opticflow/opticflow_calculator.c</a></li>
<li><a class="el" href="size__divergence_8c.html">modules/computer_vision/opticflow/size_divergence.c</a></li>
<li><a class="el" href="linear__flow__fit_8c.html">modules/computer_vision/opticflow/linear_flow_fit.c</a></li>
<li><a class="el" href="pprz__algebra__float_8c.html">math/pprz_algebra_float.c</a></li>
<li><a class="el" href="pprz__matrix__decomp__float_8c.html">math/pprz_matrix_decomp_float.c</a></li>
<li><a class="el" href="fast__rosten_8c.html">modules/computer_vision/lib/vision/fast_rosten.c</a></li>
<li><a class="el" href="lucas__kanade_8c.html">modules/computer_vision/lib/vision/lucas_kanade.c</a></li>
<li><a class="el" href="edge__flow_8c.html">modules/computer_vision/lib/vision/edge_flow.c</a></li>
<li><a class="el" href="kalman__filter__vision_8c.html">modules/computer_vision/lib/filters/kalman_filter_vision.c</a></li>
</ul>
<h2><a class="anchor" id="module_xml__cv_opticflow"></a>
Raw cv_opticflow.xml file:</h2>
<div class="fragment"><div class="line">&lt;!DOCTYPE module SYSTEM &quot;module.dtd&quot;&gt;</div>
<div class="line"></div>
<div class="line">&lt;module name=&quot;cv_opticflow&quot; dir=&quot;computer_vision&quot;&gt;</div>
<div class="line">  &lt;doc&gt;</div>
<div class="line">    &lt;description&gt;</div>
<div class="line">      Compute optical flow.</div>
<div class="line">      Made for Linux video Devices.</div>
<div class="line">      Computes x and y velocity using optical flow and distance to ground (using sonar).</div>
<div class="line">    &lt;/description&gt;</div>
<div class="line"></div>
<div class="line">    &lt;!-- Optical flow calculation parameters --&gt;</div>
<div class="line">    &lt;section name=&quot;OPTICFLOW&quot; prefix=&quot;OPTICFLOW_&quot;&gt;</div>
<div class="line">      &lt;define name=&quot;AGL_ID&quot; value=&quot;ABI_BROADCAST&quot; description=&quot;ABI receive id for ABI message (sonar measurement) (default: ABI_BROADCAST)&quot;/&gt;</div>
<div class="line">&lt;define name=&quot;IMU_ID&quot; value=&quot;ABI_BROADCAST&quot; description=&quot;ABI receive id for ABI message (accelerometers) (default: ABI_BROADCAST)&quot;/&gt;</div>
<div class="line">&lt;define name=&quot;BODY_TO_IMU_ID&quot; value=&quot;ABI_BROADCAST&quot; description=&quot;ABI receive id for ABI message (body to imu quat) (default: ABI_BROADCAST)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;SEND_ABI_ID&quot; value=&quot;1&quot; description=&quot;ABI sender id for opticflow messages (default: 1)&quot;/&gt;</div>
<div class="line"></div>
<div class="line">      &lt;!-- Video device parameters --&gt;</div>
<div class="line">      &lt;define name=&quot;CAMERA&quot; value=&quot;bottom_camera|front_camera&quot; description=&quot;The V4L2 camera device that is used for the calculations&quot;/&gt;</div>
<div class="line"></div>
<div class="line">      &lt;!-- Camera parameters --&gt;</div>
<div class="line">      &lt;define name=&quot;FOV_W&quot; value=&quot;0.89360857702&quot; description=&quot;The field of view width of the bottom camera (Defaults are from an ARDrone 2)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;FOV_H&quot; value=&quot;0.67020643276&quot; description=&quot;The field of view height of the bottom camera (Defaults are from an ARDrone 2)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;FX&quot; value=&quot;343.1211&quot; description=&quot;Field in the x direction of the camera (Defaults are from an ARDrone 2)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;FY&quot; value=&quot;348.5053&quot; description=&quot;Field in the y direction of the camera (Defaults are from an ARDrone 2)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;DEROTATION_CORRECTION_FACTOR_X&quot; value=&quot;1.0&quot; description=&quot;Correction factor for derotation (in x direction), estimated from a fit between the gyro&#39;s rates and the resulting flow (caused by the camera not being exactly in the middle (Defaults are from an ARDrone 2)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;DEROTATION_CORRECTION_FACTOR_Y&quot; value=&quot;1.0&quot; description=&quot;Correction factor for derotation (in y direction), estimated from a fit between the gyro&#39;s rates and the resulting flow (caused by the camera not being exactly in the middle (Defaults are from an ARDrone 2)&quot;/&gt;</div>
<div class="line"></div>
<div class="line">      &lt;!-- General optical flow calculation parameters --&gt;</div>
<div class="line">      &lt;define name=&quot;METHOD&quot; value=&quot;0&quot; description=&quot;Method used to calculate optical flow&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;WINDOW_SIZE&quot; value=&quot;10&quot; description=&quot;Window size used for block matching (pixels)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;SEARCH_DISTANCE&quot; value=&quot;10&quot; description=&quot;Maximum search distance for blockmatching (pixels)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;SUBPIXEL_FACTOR&quot; value=&quot;10&quot; description=&quot;Amount of subpixels per pixel, used for more precise (subpixel) calculations of the flow&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;RESOLUTION_FACTOR&quot; value=&quot;1000&quot; description=&quot;The resolution factor needed to calculate the divergence without floats&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;DEROTATION&quot; value=&quot;1&quot; description=&quot;Derotation either turned on or off (depended on gyroscope measurements)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;MEDIAN_FILTER&quot; value=&quot;0&quot; description=&quot;A median filter on the resulting velocities to be turned on or off (last 5 measurements)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;KALMAN_FILTER&quot; value=&quot;1&quot; description=&quot;A kalman filter on the resulting velocities to be turned on or off (fused with accelerometers)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;KALMAN_FILTER_PROCESS_NOISE&quot; value=&quot;0.01&quot; description=&quot;The expected variance of the error of the model&#39;s prediction in the kalman filter&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;FEATURE_MANAGEMENT&quot; value=&quot;1&quot; description=&quot;Whether to keep already tracked corners in memory for the next frame or re-detect new ones every time&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;FPS&quot; value=&quot;0&quot; description=&quot;The (maximum) frequency to run the calculations at. If zero, it will max out at the camera frame rate&quot;/&gt;</div>
<div class="line"></div>
<div class="line">      &lt;!-- Lucas Kanade optical flow calculation parameters --&gt;</div>
<div class="line">      &lt;define name=&quot;MAX_TRACK_CORNERS&quot; value=&quot;25&quot; description=&quot;The maximum amount of corners the Lucas Kanade algorithm is tracking between two frames&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;MAX_ITERATIONS&quot; value=&quot;10&quot; description=&quot;Maximum number of iterations the Lucas Kanade algorithm should take&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;THRESHOLD_VEC&quot; value=&quot;2&quot; description=&quot;TThreshold in subpixels when the iterations of Lucas Kanade should stop&quot;/&gt;</div>
<div class="line"></div>
<div class="line">      &lt;!-- FAST9 corner detection parameters --&gt;</div>
<div class="line">      &lt;define name=&quot;FAST9_ADAPTIVE&quot; value=&quot;TRUE&quot; description=&quot;Whether we should use and adapative FAST9 crner detection threshold&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;FAST9_THRESHOLD&quot; value=&quot;20&quot; description=&quot;FAST9 default threshold&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;FAST9_MIN_DISTANCE&quot; value=&quot;10&quot; description=&quot;The amount of pixels between corners that should be detected&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;FAST9_PADDING&quot; value=&quot;20&quot; description=&quot;The outer border in which no corners will be searched&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;FAST9_REGION_DETECT&quot; value=&quot;1&quot; description=&quot;Whether to detect fast9 corners in regions of interest or the whole image (only works with feature management)&quot;/&gt;</div>
<div class="line">      &lt;define name=&quot;FAST9_NUM_REGIONS&quot; value=&quot;9&quot; description=&quot;The number of regions of interest to split the image into&quot;/&gt;</div>
<div class="line">    &lt;/section&gt;</div>
<div class="line">  &lt;/doc&gt;</div>
<div class="line"></div>
<div class="line">  &lt;settings&gt;</div>
<div class="line">  &lt;dl_settings NAME=&quot;Vision stabilization&quot;&gt;</div>
<div class="line"></div>
<div class="line">        &lt;!-- Optical flow calculations parameters --&gt;</div>
<div class="line">      &lt;dl_settings name=&quot;vision_calc&quot;&gt;</div>
<div class="line">      &lt;dl_setting var=&quot;opticflow.method&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;1&quot; module=&quot;computer_vision/opticflow_module&quot; shortname=&quot;method&quot; values=&quot;LK_Fast9|EdgeFlow&quot; param=&quot;METHOD&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.window_size&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;20&quot; shortname=&quot;window_size&quot; param=&quot;OPTICFLOW_WINDOW_SIZE&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.search_distance&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;50&quot; shortname=&quot;search_distance&quot; param=&quot;SEARCH_DISTANCE&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.subpixel_factor&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;10&quot; max=&quot;1000&quot; shortname=&quot;subpixel_factor&quot; param=&quot;OPTICFLOW_SUBPIXEL_FACTOR&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.resolution_factor&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;10&quot; step=&quot;10&quot; max=&quot;10000&quot; shortname=&quot;resolution_factor&quot; param=&quot;OPTICFLOW_RESOLUTION_FACTOR&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.derotation&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;1&quot; module=&quot;computer_vision/opticflow_module&quot; values=&quot;OFF|ON&quot; shortname=&quot;derotation&quot; param=&quot;OPTICFLOW_DEROTATION&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.median_filter&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;1&quot; values=&quot;OFF|ON&quot; shortname=&quot;median_filter&quot; param=&quot;OPTICFLOW_MEDIAN_FILTER&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.kalman_filter&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;1&quot; values=&quot;OFF|ON&quot; shortname=&quot;kalman_filter&quot; param=&quot;OPTICFLOW_KALMAN_FILTER&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.kalman_filter_process_noise&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0.0001&quot; step=&quot;0.0001&quot; max=&quot;0.1&quot;  shortname=&quot;KF_process_noise&quot; param=&quot;OPTICFLOW_KALMAN_FILTER_PROCESS_NOISE&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.feature_management&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;1&quot; values=&quot;OFF|ON&quot; shortname=&quot;feature_management&quot; param=&quot;OPTICFLOW_FEATURE_MANAGEMENT&quot;/&gt;</div>
<div class="line"></div>
<div class="line">  &lt;!-- Specifically for Lucas Kanade and FAST9 --&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.max_track_corners&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;500&quot; shortname=&quot;max_trck_corners&quot; param=&quot;OPTICFLOW_MAX_TRACK_CORNERS&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.max_iterations&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;100&quot; shortname=&quot;max_iterations&quot; param=&quot;OPTICFLOW_MAX_ITERATIONS&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.threshold_vec&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;100&quot; shortname=&quot;threshold_vec&quot; param=&quot;OPTICFLOW_THRESHOLD_VEC&quot;/&gt;</div>
<div class="line"></div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.fast9_adaptive&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;1&quot; values=&quot;FALSE|TRUE&quot; shortname=&quot;fast9_adaptive&quot; param=&quot;OPTICFLOW_FAST9_ADAPTIVE&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.fast9_threshold&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;255&quot; shortname=&quot;fast9_threshold&quot; param=&quot;OPTICFLOW_FAST9_THRESHOLD&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.fast9_min_distance&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;500&quot; shortname=&quot;fast9_min_distance&quot; param=&quot;OPTICFLOW_FAST9_MIN_DISTANCE&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.fast9_padding&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;50&quot; shortname=&quot;fast9_padding&quot; param=&quot;OPTICFLOW_FAST9_PADDING&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.fast9_region_detect&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;1&quot; values=&quot;OFF|ON&quot; shortname=&quot;fast9_region_detect&quot; param=&quot;OPTICFLOW_FAST9_REGION_DETECT&quot;/&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.fast9_num_regions&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;1&quot; step=&quot;1&quot; max=&quot;25&quot; shortname=&quot;fast9_num_regions&quot; param=&quot;OPTICFLOW_FAST9_NUM_REGIONS&quot;/&gt;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  &lt;!-- Changes pyramid level of lucas kanade optical flow. --&gt;</div>
<div class="line">        &lt;dl_setting var=&quot;opticflow.pyramid_level&quot; module=&quot;computer_vision/opticflow_module&quot; min=&quot;0&quot; step=&quot;1&quot; max=&quot;10&quot; shortname=&quot;pyramid_level&quot; param=&quot;OPTICFLOW_PYRAMID_LEVEL&quot;/&gt;</div>
<div class="line"></div>
<div class="line">      &lt;/dl_settings&gt;</div>
<div class="line">    &lt;/dl_settings&gt;</div>
<div class="line">  &lt;/settings&gt;</div>
<div class="line"></div>
<div class="line">  &lt;depends&gt;video_thread,pose_history&lt;/depends&gt;</div>
<div class="line"></div>
<div class="line">  &lt;header&gt;</div>
<div class="line">    &lt;file name=&quot;opticflow_module.h&quot;/&gt;</div>
<div class="line">  &lt;/header&gt;</div>
<div class="line"></div>
<div class="line">  &lt;init fun=&quot;opticflow_module_init()&quot;/&gt;</div>
<div class="line">  &lt;periodic fun=&quot;opticflow_module_run()&quot; autorun=&quot;TRUE&quot;/&gt;</div>
<div class="line"></div>
<div class="line">  &lt;makefile target=&quot;ap&quot;&gt;</div>
<div class="line">    &lt;!-- Include the needed Computer Vision files --&gt;</div>
<div class="line">    &lt;include name=&quot;modules/computer_vision&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;image.c&quot; dir=&quot;modules/computer_vision/lib/vision&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;jpeg.c&quot; dir=&quot;modules/computer_vision/lib/encoding&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;rtp.c&quot; dir=&quot;modules/computer_vision/lib/encoding&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;v4l2.c&quot; dir=&quot;modules/computer_vision/lib/v4l&quot;/&gt;</div>
<div class="line"></div>
<div class="line">    &lt;!-- The optical flow module (calculator) --&gt;</div>
<div class="line">    &lt;file name=&quot;opticflow_module.c&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;opticflow_calculator.c&quot; dir=&quot;modules/computer_vision/opticflow&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;size_divergence.c&quot; dir=&quot;modules/computer_vision/opticflow&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;linear_flow_fit.c&quot; dir=&quot;modules/computer_vision/opticflow&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;pprz_algebra_float.c&quot; dir=&quot;math&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;pprz_matrix_decomp_float.c&quot; dir=&quot;math&quot;/&gt;</div>
<div class="line"></div>
<div class="line">    &lt;!-- Main vision calculations --&gt;</div>
<div class="line">    &lt;file name=&quot;fast_rosten.c&quot; dir=&quot;modules/computer_vision/lib/vision&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;lucas_kanade.c&quot; dir=&quot;modules/computer_vision/lib/vision&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;edge_flow.c&quot; dir=&quot;modules/computer_vision/lib/vision&quot;/&gt;</div>
<div class="line">    &lt;file name=&quot;kalman_filter_vision.c&quot; dir=&quot;modules/computer_vision/lib/filters&quot;/&gt;</div>
<div class="line">  &lt;/makefile&gt;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">&lt;/module&gt;</div>
<div class="line"></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="onboard_modules.html">Onboard Modules</a></li>
    <li class="footer">Generated on Wed Nov 8 2017 12:03:29 for Paparazzi UAS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
